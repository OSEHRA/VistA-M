SYNDHP30A ; HC/art - HealthConcourse - continuation of get Pharmacy Patient data ;08/28/2019
 ;;1.0;DHP;;Jan 17, 2017;Build 46
 ;;
 ;;Original routine authored by Andrew Thompson & Ferdinand Frankson of Perspecta 2017-2019
 ;
 QUIT
 ;
PHCONT1 ; continuation of get Pharmacy Patient data
 ;
 N IENS5 S IENS5=""
 F  S IENS5=$O(PHPATARR(FNBR5,IENS5)) QUIT:IENS5=""  D
 . N UNIT S UNIT=$NA(PHPAT("Phpat","unitDoses","unitDose",+IENS5))
 . S @UNIT@("orderNumber")=$G(PHPATARR(FNBR5,IENS5,.01,"E"))
 . S @UNIT@("priority")=$G(PHPATARR(FNBR5,IENS5,.24,"E"))
 . S @UNIT@("priorityCd")=$G(PHPATARR(FNBR5,IENS5,.24,"I"))
 . S @UNIT@("originalOrderNumber")=$G(PHPATARR(FNBR5,IENS5,.25,"E"))
 . S @UNIT@("patientName")=$G(PHPATARR(FNBR5,IENS5,.5,"E"))
 . S @UNIT@("patientNameId")=$G(PHPATARR(FNBR5,IENS5,.5,"I"))
 . S @UNIT@("patientNameICN")=$$GET1^DIQ(2,@UNIT@("patientNameId")_",",991.1)
 . S @UNIT@("provider")=$G(PHPATARR(FNBR5,IENS5,1,"E"))
 . S @UNIT@("providerId")=$G(PHPATARR(FNBR5,IENS5,1,"I"))
 . S @UNIT@("providerNPI")=$$GET1^DIQ(200,@UNIT@("providerId")_",",41.99) ;NPI
 . S @UNIT@("providerResId")=$$RESID^SYNDHP69("V",SITE,200,@UNIT@("providerId"))
 . S @UNIT@("medRoute")=$G(PHPATARR(FNBR5,IENS5,3,"E"))
 . S @UNIT@("medRouteId")=$G(PHPATARR(FNBR5,IENS5,3,"I"))
 . S @UNIT@("type")=$G(PHPATARR(FNBR5,IENS5,4,"E"))
 . S @UNIT@("typeCd")=$G(PHPATARR(FNBR5,IENS5,4,"I"))
 . S @UNIT@("selfMed")=$G(PHPATARR(FNBR5,IENS5,5,"E"))
 . S @UNIT@("selfMedCd")=$G(PHPATARR(FNBR5,IENS5,5,"I"))
 . S @UNIT@("hospitalSuppliedSelfMed")=$G(PHPATARR(FNBR5,IENS5,6,"E"))
 . S @UNIT@("hospitalSuppliedSelfMedCd")=$G(PHPATARR(FNBR5,IENS5,6,"I"))
 . S @UNIT@("scheduleType")=$G(PHPATARR(FNBR5,IENS5,7,"E"))
 . S @UNIT@("scheduleTypeCd")=$G(PHPATARR(FNBR5,IENS5,7,"I"))
 . S @UNIT@("specialInstructions")=$G(PHPATARR(FNBR5,IENS5,8,"E"))
 . S @UNIT@("originalWard")=$G(PHPATARR(FNBR5,IENS5,9,"E"))
 . S @UNIT@("originalWardId")=$G(PHPATARR(FNBR5,IENS5,9,"I"))
 . S @UNIT@("startDateTime")=$G(PHPATARR(FNBR5,IENS5,10,"E"))
 . S @UNIT@("startDateTimeFM")=$G(PHPATARR(FNBR5,IENS5,10,"I"))
 . S @UNIT@("startDateTimeHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,10,"I")))
 . S @UNIT@("startDateTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,10,"I")))
 . S @UNIT@("dayLimit")=$G(PHPATARR(FNBR5,IENS5,11,"E"))
 . S @UNIT@("doseLimit")=$G(PHPATARR(FNBR5,IENS5,12,"E"))
 . S @UNIT@("comments")=""
 . N Z S Z=""
 . F  S Z=$O(PHPATARR(FNBR5,IENS5,15,Z)) QUIT:'+Z  D
 . . S @UNIT@("comments")=@UNIT@("comments")_$G(PHPATARR(FNBR5,IENS5,15,Z))
 . S @UNIT@("verifyingNurse")=$G(PHPATARR(FNBR5,IENS5,16,"E"))
 . S @UNIT@("verifyingNurseId")=$G(PHPATARR(FNBR5,IENS5,16,"I"))
 . S @UNIT@("verifyingNurseResId")=$$RESID^SYNDHP69("V",SITE,200,@UNIT@("verifyingNurseId"))
 . S @UNIT@("dateVerifiedByNurse")=$G(PHPATARR(FNBR5,IENS5,17,"E"))
 . S @UNIT@("dateVerifiedByNurseFM")=$G(PHPATARR(FNBR5,IENS5,17,"I"))
 . S @UNIT@("dateVerifiedByNurseHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,17,"I")))
 . S @UNIT@("dateVerifiedByNurseFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,17,"I")))
 . S @UNIT@("verifyingPharmacist")=$G(PHPATARR(FNBR5,IENS5,18,"E"))
 . S @UNIT@("verifyingPharmacistId")=$G(PHPATARR(FNBR5,IENS5,18,"I"))
 . S @UNIT@("verifyingPharmacistResId")=$$RESID^SYNDHP69("V",SITE,200,@UNIT@("verifyingPharmacistId"))
 . S @UNIT@("dateVerifiedByPharmacist")=$G(PHPATARR(FNBR5,IENS5,19,"E"))
 . S @UNIT@("dateVerifiedByPharmacistFM")=$G(PHPATARR(FNBR5,IENS5,19,"I"))
 . S @UNIT@("dateVerifiedByPharmacistHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,19,"I")))
 . S @UNIT@("dateVerifiedByPharmacistFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,19,"I")))
 . S @UNIT@("physician")=$G(PHPATARR(FNBR5,IENS5,20,"E"))
 . S @UNIT@("physicianId")=$G(PHPATARR(FNBR5,IENS5,20,"I"))
 . S @UNIT@("physicianNPI")=$$GET1^DIQ(200,@UNIT@("physicianId")_",",41.99) ;NPI
 . S @UNIT@("physicianResId")=$$RESID^SYNDHP69("V",SITE,200,@UNIT@("physicianId"))
 . S @UNIT@("dateVerifiedByPhysician")=$G(PHPATARR(FNBR5,IENS5,21,"E"))
 . S @UNIT@("dateVerifiedByPhysicianFM")=$G(PHPATARR(FNBR5,IENS5,21,"I"))
 . S @UNIT@("dateVerifiedByPhysicianHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,21,"I")))
 . S @UNIT@("dateVerifiedByPhysicianFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,21,"I")))
 . S @UNIT@("clerk")=$G(PHPATARR(FNBR5,IENS5,22,"E"))
 . S @UNIT@("clerkId")=$G(PHPATARR(FNBR5,IENS5,22,"I"))
 . S @UNIT@("clerkResId")=$$RESID^SYNDHP69("V",SITE,200,@UNIT@("clerkId"))
 . S @UNIT@("dateEnteredByClerk")=$G(PHPATARR(FNBR5,IENS5,23,"E"))
 . S @UNIT@("dateEnteredByClerkFM")=$G(PHPATARR(FNBR5,IENS5,23,"I"))
 . S @UNIT@("dateEnteredByClerkHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,23,"I")))
 . S @UNIT@("dateEnteredByClerkFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,23,"I")))
 . S @UNIT@("previousStopDateTime")=$G(PHPATARR(FNBR5,IENS5,25,"E"))
 . S @UNIT@("previousStopDateTimeFM")=$G(PHPATARR(FNBR5,IENS5,25,"I"))
 . S @UNIT@("previousStopDateTimeHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,25,"I")))
 . S @UNIT@("previousStopDateTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,25,"I")))
 . S @UNIT@("schedule")=$G(PHPATARR(FNBR5,IENS5,26,"E"))
 . S @UNIT@("orderDate")=$G(PHPATARR(FNBR5,IENS5,27,"E"))
 . S @UNIT@("orderDateFM")=$G(PHPATARR(FNBR5,IENS5,27,"I"))
 . S @UNIT@("orderDateHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,27,"I")))
 . S @UNIT@("orderDateFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,27,"I")))
 . S @UNIT@("logInDate")=$G(PHPATARR(FNBR5,IENS5,27.1,"E"))
 . S @UNIT@("logInDateFM")=$G(PHPATARR(FNBR5,IENS5,27.1,"I"))
 . S @UNIT@("logInDateHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,27.1,"I")))
 . S @UNIT@("logInDateFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,27.1,"I")))
 . S @UNIT@("status")=$G(PHPATARR(FNBR5,IENS5,28,"E"))
 . S @UNIT@("statusCd")=$G(PHPATARR(FNBR5,IENS5,28,"I"))
 . S @UNIT@("stopDateTime")=$G(PHPATARR(FNBR5,IENS5,34,"E"))
 . S @UNIT@("stopDateTimeFM")=$G(PHPATARR(FNBR5,IENS5,34,"I"))
 . S @UNIT@("stopDateTimeHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,34,"I")))
 . S @UNIT@("stopDateTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,34,"I")))
 . S @UNIT@("adminTimes")=$G(PHPATARR(FNBR5,IENS5,41,"E"))
 . S @UNIT@("frequencyInMinutes")=$G(PHPATARR(FNBR5,IENS5,42,"E"))
 . S @UNIT@("renewal")=$G(PHPATARR(FNBR5,IENS5,43,"E"))
 . S @UNIT@("renewalCd")=$G(PHPATARR(FNBR5,IENS5,43,"I"))
 . S @UNIT@("renewalUser")=$G(PHPATARR(FNBR5,IENS5,44,"E"))
 . S @UNIT@("renewalUserId")=$G(PHPATARR(FNBR5,IENS5,44,"I"))
 . S @UNIT@("dateRenewalMarked")=$G(PHPATARR(FNBR5,IENS5,45,"E"))
 . S @UNIT@("dateRenewalMarkedFM")=$G(PHPATARR(FNBR5,IENS5,45,"I"))
 . S @UNIT@("dateRenewalMarkedHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,45,"I")))
 . S @UNIT@("dateRenewalMarkedFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,45,"I")))
 . S @UNIT@("markedCancelled")=$G(PHPATARR(FNBR5,IENS5,46,"E"))
 . S @UNIT@("markedCancelledCd")=$G(PHPATARR(FNBR5,IENS5,46,"I"))
 . S @UNIT@("markedCancelledUser")=$G(PHPATARR(FNBR5,IENS5,47,"E"))
 . S @UNIT@("markedCancelledUserId")=$G(PHPATARR(FNBR5,IENS5,47,"I"))
 . S @UNIT@("dateMarkedCancelled")=$G(PHPATARR(FNBR5,IENS5,48,"E"))
 . S @UNIT@("dateMarkedCancelledFM")=$G(PHPATARR(FNBR5,IENS5,48,"I"))
 . S @UNIT@("dateMarkedCancelledHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,48,"I")))
 . S @UNIT@("dateMarkedCancelledFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,48,"I")))
 . S @UNIT@("autoCancelledFlag")=$G(PHPATARR(FNBR5,IENS5,49,"E"))
 . S @UNIT@("autoCancelledFlagCd")=$G(PHPATARR(FNBR5,IENS5,49,"I"))
 . S @UNIT@("pvFlag")=$G(PHPATARR(FNBR5,IENS5,50,"E"))
 . S @UNIT@("pvFlagCd")=$G(PHPATARR(FNBR5,IENS5,50,"I"))
 . S @UNIT@("nvFlag")=$G(PHPATARR(FNBR5,IENS5,51,"E"))
 . S @UNIT@("nvFlagCd")=$G(PHPATARR(FNBR5,IENS5,51,"I"))
 . S @UNIT@("labelDate")=$G(PHPATARR(FNBR5,IENS5,52,"E"))
 . S @UNIT@("labelDateFM")=$G(PHPATARR(FNBR5,IENS5,52,"I"))
 . S @UNIT@("labelDateHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,52,"I")))
 . S @UNIT@("labelDateFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,52,"I")))
 . S @UNIT@("labelReason")=$G(PHPATARR(FNBR5,IENS5,53,"E"))
 . S @UNIT@("labelReasonCd")=$G(PHPATARR(FNBR5,IENS5,53,"I"))
 . S @UNIT@("holdFlag")=$G(PHPATARR(FNBR5,IENS5,56,"E"))
 . S @UNIT@("holdFlagCd")=$G(PHPATARR(FNBR5,IENS5,56,"I"))
 . S @UNIT@("holdUser")=$G(PHPATARR(FNBR5,IENS5,57,"E"))
 . S @UNIT@("holdUserId")=$G(PHPATARR(FNBR5,IENS5,57,"I"))
 . S @UNIT@("holdDate")=$G(PHPATARR(FNBR5,IENS5,58,"E"))
 . S @UNIT@("holdDateFM")=$G(PHPATARR(FNBR5,IENS5,58,"I"))
 . S @UNIT@("holdDateHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,58,"I")))
 . S @UNIT@("holdDateFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,58,"I")))
 . S @UNIT@("holdStatus")=$G(PHPATARR(FNBR5,IENS5,59,"E"))
 . S @UNIT@("holdStatusCd")=$G(PHPATARR(FNBR5,IENS5,59,"I"))
 . S @UNIT@("oerrHoldFlag")=$G(PHPATARR(FNBR5,IENS5,59.1,"E"))
 . S @UNIT@("oerrHoldFlagCd")=$G(PHPATARR(FNBR5,IENS5,59.1,"I"))
 . S @UNIT@("offHoldFlag")=$G(PHPATARR(FNBR5,IENS5,60,"E"))
 . S @UNIT@("offHoldFlagCd")=$G(PHPATARR(FNBR5,IENS5,60,"I"))
 . S @UNIT@("offHoldUser")=$G(PHPATARR(FNBR5,IENS5,61,"E"))
 . S @UNIT@("offHoldUserId")=$G(PHPATARR(FNBR5,IENS5,61,"I"))
 . S @UNIT@("offHoldDate")=$G(PHPATARR(FNBR5,IENS5,62,"E"))
 . S @UNIT@("offHoldDateFM")=$G(PHPATARR(FNBR5,IENS5,62,"I"))
 . S @UNIT@("offHoldDateHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,62,"I")))
 . S @UNIT@("offHoldDateFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,62,"I")))
 . S @UNIT@("purgeFlag")=$G(PHPATARR(FNBR5,IENS5,64,"E"))
 . S @UNIT@("purgeFlagFM")=$G(PHPATARR(FNBR5,IENS5,64,"I"))
 . S @UNIT@("purgeFlagHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,64,"I")))
 . S @UNIT@("purgeFlagFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,64,"I")))
 . S @UNIT@("ordersFileEntry")=$G(PHPATARR(FNBR5,IENS5,66,"E"))
 . S @UNIT@("mergedPatient")=$G(PHPATARR(FNBR5,IENS5,67,"E"))
 . S @UNIT@("lastWard")=$G(PHPATARR(FNBR5,IENS5,68,"E"))
 . S @UNIT@("lastWardId")=$G(PHPATARR(FNBR5,IENS5,68,"I"))
 . S @UNIT@("NotToBeGivenFlag")=$G(PHPATARR(FNBR5,IENS5,69,"E"))
 . S @UNIT@("NotToBeGivenFlagCd")=$G(PHPATARR(FNBR5,IENS5,69,"I"))
 . S @UNIT@("originalStartDateTime")=$G(PHPATARR(FNBR5,IENS5,70,"E"))
 . S @UNIT@("originalStartDateTimeFM")=$G(PHPATARR(FNBR5,IENS5,70,"I"))
 . S @UNIT@("originalStartDateTimeHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,70,"I")))
 . S @UNIT@("originalStartDateTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,70,"I")))
 . S @UNIT@("providerComments")=""
 . N Z S Z=""
 . F  S Z=$O(PHPATARR(FNBR5,IENS5,72,Z)) QUIT:'+Z  D
 . . S @UNIT@("providerComments")=@UNIT@("providerComments")_$G(PHPATARR(FNBR5,IENS5,72,Z))
 . S @UNIT@("reasonOrderCreated")=$G(PHPATARR(FNBR5,IENS5,103,"E"))
 . S @UNIT@("reasonOrderCreatedCd")=$G(PHPATARR(FNBR5,IENS5,103,"I"))
 . S @UNIT@("previousOrder")=$G(PHPATARR(FNBR5,IENS5,104,"E"))
 . S @UNIT@("followingOrder")=$G(PHPATARR(FNBR5,IENS5,105,"E"))
 . S @UNIT@("reasonForFollowingOrder")=$G(PHPATARR(FNBR5,IENS5,107,"E"))
 . S @UNIT@("reasonForFollowingOrderCd")=$G(PHPATARR(FNBR5,IENS5,107,"I"))
 . S @UNIT@("orderableItem")=$G(PHPATARR(FNBR5,IENS5,108,"E"))
 . S @UNIT@("orderableItemId")=$G(PHPATARR(FNBR5,IENS5,108,"I"))
 . S @UNIT@("dosageOrdered")=$G(PHPATARR(FNBR5,IENS5,109,"E"))
 . S @UNIT@("natureOfOrder")=$G(PHPATARR(FNBR5,IENS5,110,"E"))
 . S @UNIT@("natureOfOrderCd")=$G(PHPATARR(FNBR5,IENS5,110,"I"))
 . S @UNIT@("instructions")=$G(PHPATARR(FNBR5,IENS5,111,"E"))
 . S @UNIT@("dose")=$G(PHPATARR(FNBR5,IENS5,120,"E"))
 . S @UNIT@("unit")=$G(PHPATARR(FNBR5,IENS5,121,"E"))
 . S @UNIT@("siOpiFlag")=$G(PHPATARR(FNBR5,IENS5,122,"E"))
 . S @UNIT@("siOpiFlagCd")=$G(PHPATARR(FNBR5,IENS5,122,"I"))
 . S @UNIT@("bcmaExpiredFlag")=$G(PHPATARR(FNBR5,IENS5,123,"E"))
 . S @UNIT@("bcmaExpiredFlagCd")=$G(PHPATARR(FNBR5,IENS5,123,"I"))
 . S @UNIT@("flagged")=$G(PHPATARR(FNBR5,IENS5,124,"E"))
 . S @UNIT@("flaggedCd")=$G(PHPATARR(FNBR5,IENS5,124,"I"))
 . S @UNIT@("ordersFileParentOrder")=$G(PHPATARR(FNBR5,IENS5,125,"E"))
 . S @UNIT@("requestedDuration")=$G(PHPATARR(FNBR5,IENS5,126,"E"))
 . S @UNIT@("mostRecentFlagComment")=$G(PHPATARR(FNBR5,IENS5,128,"E"))
 . S @UNIT@("clinic")=$G(PHPATARR(FNBR5,IENS5,130,"E"))
 . S @UNIT@("clinicId")=$G(PHPATARR(FNBR5,IENS5,130,"I"))
 . S @UNIT@("appointmentDateTime")=$G(PHPATARR(FNBR5,IENS5,131,"E"))
 . S @UNIT@("appointmentDateTimeFM")=$G(PHPATARR(FNBR5,IENS5,131,"I"))
 . S @UNIT@("appointmentDateTimeHL7")=$$FMTHL7^XLFDT($G(PHPATARR(FNBR5,IENS5,131,"I")))
 . S @UNIT@("appointmentDateTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(PHPATARR(FNBR5,IENS5,131,"I")))
 . S @UNIT@("specialInstructionsLong")=""
 . N Z S Z=""
 . F  S Z=$O(PHPATARR(FNBR5,IENS5,135,Z)) QUIT:'+Z  D
 . . S @UNIT@("specialInstructionsLong")=@UNIT@("specialInstructionsLong")_$G(PHPATARR(FNBR5,IENS5,135,Z))
 . S @UNIT@("displayStatus")=$G(PHPATARR(FNBR5,IENS5,136,"E"))
 . S @UNIT@("displayStatusCd")=$G(PHPATARR(FNBR5,IENS5,136,"I"))
 . S @UNIT@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,PHPATIEN,FNBR5_U_+IENS5)
 ;
 QUIT
 ;
