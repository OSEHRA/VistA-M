SYNDHP12 ; HC/art - HealthConcourse - get immunization record ;08/27/2019
 ;;1.0;DHP;;Jan 17, 2017;Build 46
 ;;
 ;;Original routine authored by Andrew Thompson & Ferdinand Frankson of Perspecta 2017-2019
 ;
 QUIT
 ;
 ;-------------------------------------------------------------
 ;
GET1IMMUN(IMMUNIZE,IMMUNIEN,RETJSON,IMMUNIZEJ) ;get one Immunization record
 ;inputs: IMMUNIEN - Immunization IEN
 ;        RETJSON - J = Return JSON
 ;output: IMMUNIZE  - array of Immunization data, by reference
 ;        IMMUNIZEJ - JSON structure of Immunization data, by reference
 ;
 I $G(DEBUG) W !,"--------------------------- Immunize -----------------------------",!
 N S S S="_"
 N SITE S SITE=$P($$SITE^VASITE,"^",3)
 N FNBR1 S FNBR1=9000010.11 ;V IMMUNIZATION
 N FNBR2 S FNBR2=9000010.112 ;VIS OFFERED/GIVEN TO PATIENT
 N FNBR3 S FNBR3=9000010.113 ;OTHER DIAGNOSIS
 N FNBR4 S FNBR4=9000010.1182 ;DISCLOSED TO
 N FNBR5 S FNBR5=9000010.1111 ;REMARKS
 N FNBR6 S FNBR6=9000010.1126 ;SNOMED CT
 N FNBR7 S FNBR7=9000010.1127 ;LOINC CODES
 N IENS1 S IENS1=IMMUNIEN_","
 ;
 N IMMUNIZEARR,IMMUNIZEERR
 D GETS^DIQ(FNBR1,IENS1,"**","EI","IMMUNIZEARR","IMMUNIZEERR")
 I $G(DEBUG) W ! W $$ZW^SYNDHPUTL("IMMUNIZEARR")
 I $G(DEBUG),$D(IMMUNIZEERR) W ">>ERROR<<",! W $$ZW^SYNDHPUTL("IMMUNIZEERR")
 I $D(IMMUNIZEERR) D  QUIT
 . S IMMUNIZE("Immunize","ERROR")=IMMUNIEN
 . D:$G(RETJSON)="J" TOJASON^SYNDHPUTL(.IMMUNIZE,.IMMUNIZEJ)
 N IMMUNE S IMMUNE=$NA(IMMUNIZE("Immunize"))
 S @IMMUNE@("immunizeIen")=IMMUNIEN
 S @IMMUNE@("resourceType")="Immunization"
 S @IMMUNE@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,IMMUNIEN)
 S @IMMUNE@("immunization")=$G(IMMUNIZEARR(FNBR1,IENS1,.01,"E"))
 S @IMMUNE@("immunizationId")=$G(IMMUNIZEARR(FNBR1,IENS1,.01,"I"))
 S @IMMUNE@("patientName")=$G(IMMUNIZEARR(FNBR1,IENS1,.02,"E"))
 S @IMMUNE@("patientNameId")=$G(IMMUNIZEARR(FNBR1,IENS1,.02,"I"))
 S @IMMUNE@("patientICN")=$$GET1^DIQ(2,@IMMUNE@("patientNameId")_",",991.1)
 S @IMMUNE@("visit")=$G(IMMUNIZEARR(FNBR1,IENS1,.03,"E"))
 S @IMMUNE@("visitId")=$G(IMMUNIZEARR(FNBR1,IENS1,.03,"I"))
 S @IMMUNE@("visitFM")=$$GET1^DIQ(9000010,@IMMUNE@("visitId")_",",.01,"I")
 S @IMMUNE@("visitHL7")=$$FMTHL7^XLFDT(@IMMUNE@("visitFM"))
 S @IMMUNE@("visitFHIR")=$$FMTFHIR^SYNDHPUTL(@IMMUNE@("visitFM"))
 S @IMMUNE@("visitResId")=$$RESID^SYNDHP69("V",SITE,9000010,@IMMUNE@("visitId"))
 S @IMMUNE@("location")=$$GET1^DIQ(9000010,@IMMUNE@("visitId"),.06)
 S @IMMUNE@("locationId")=$$GET1^DIQ(9000010,@IMMUNE@("visitId"),.06,"I")
 S @IMMUNE@("series")=$G(IMMUNIZEARR(FNBR1,IENS1,.04,"E"))
 S @IMMUNE@("seriesCd")=$G(IMMUNIZEARR(FNBR1,IENS1,.04,"I"))
 S @IMMUNE@("lot")=$G(IMMUNIZEARR(FNBR1,IENS1,.05,"E"))
 S @IMMUNE@("lotId")=$G(IMMUNIZEARR(FNBR1,IENS1,.05,"I"))
 S @IMMUNE@("reaction")=$G(IMMUNIZEARR(FNBR1,IENS1,.06,"E"))
 S @IMMUNE@("reactionCd")=$G(IMMUNIZEARR(FNBR1,IENS1,.06,"I"))
 S @IMMUNE@("contraindicated")=$G(IMMUNIZEARR(FNBR1,IENS1,.07,"E"))
 S @IMMUNE@("contraindicatedCd")=$G(IMMUNIZEARR(FNBR1,IENS1,.07,"I"))
 S @IMMUNE@("doseOverride")=$G(IMMUNIZEARR(FNBR1,IENS1,.08,"E"))
 S @IMMUNE@("doseOverrideCd")=$G(IMMUNIZEARR(FNBR1,IENS1,.08,"I"))
 S @IMMUNE@("injectionSite")=$G(IMMUNIZEARR(FNBR1,IENS1,.09,"E"))
 S @IMMUNE@("injectionSiteCd")=$G(IMMUNIZEARR(FNBR1,IENS1,.09,"I"))
 S @IMMUNE@("volume")=$G(IMMUNIZEARR(FNBR1,IENS1,.11,"E"))
 S @IMMUNE@("dateOfVacInfoStatement")=$G(IMMUNIZEARR(FNBR1,IENS1,.12,"E"))
 S @IMMUNE@("dateOfVacInfoStatementFM")=$G(IMMUNIZEARR(FNBR1,IENS1,.12,"I"))
 S @IMMUNE@("dateOfVacInfoStatementHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,.12,"I")))
 S @IMMUNE@("dateOfVacInfoStatementFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,.12,"I")))
 S @IMMUNE@("createdByVCptEntry")=$G(IMMUNIZEARR(FNBR1,IENS1,.13,"E"))
 S @IMMUNE@("vacEligibility")=$G(IMMUNIZEARR(FNBR1,IENS1,.14,"E"))
 S @IMMUNE@("vacEligibilityId")=$G(IMMUNIZEARR(FNBR1,IENS1,.14,"I"))
 S @IMMUNE@("importFromOutsideRegistry")=$G(IMMUNIZEARR(FNBR1,IENS1,.15,"E"))
 S @IMMUNE@("importFromOutsideRegistryCd")=$G(IMMUNIZEARR(FNBR1,IENS1,.15,"I"))
 S @IMMUNE@("ndc")=$G(IMMUNIZEARR(FNBR1,IENS1,.16,"E"))
 S @IMMUNE@("ndcId")=$G(IMMUNIZEARR(FNBR1,IENS1,.16,"I"))
 S @IMMUNE@("administrativeNotes")=$G(IMMUNIZEARR(FNBR1,IENS1,1,"E"))
 S @IMMUNE@("remarks")=""
 N Z S Z=""
 F  S Z=$O(IMMUNIZEARR(FNBR1,IENS1,1101,Z)) QUIT:'+Z  D
 . S @IMMUNE@("remarks")=@IMMUNE@("remarks")_$G(IMMUNIZEARR(FNBR1,IENS1,1101,Z))
 S @IMMUNE@("eventDateAndTime")=$G(IMMUNIZEARR(FNBR1,IENS1,1201,"E"))
 S @IMMUNE@("eventDateAndTimeFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1201,"I"))
 S @IMMUNE@("eventDateAndTimeHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1201,"I")))
 S @IMMUNE@("eventDateAndTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1201,"I")))
 S @IMMUNE@("orderingProvider")=$G(IMMUNIZEARR(FNBR1,IENS1,1202,"E"))
 S @IMMUNE@("orderingProviderId")=$G(IMMUNIZEARR(FNBR1,IENS1,1202,"I"))
 S @IMMUNE@("orderingProviderNPI")=$$GET1^DIQ(200,@IMMUNE@("orderingProviderId")_",",41.99) ;NPI
 S @IMMUNE@("orderingProviderResId")=$$RESID^SYNDHP69("V",SITE,200,@IMMUNE@("orderingProviderId"))
 S @IMMUNE@("clinic")=$G(IMMUNIZEARR(FNBR1,IENS1,1203,"E"))
 S @IMMUNE@("clinicId")=$G(IMMUNIZEARR(FNBR1,IENS1,1203,"I"))
 S @IMMUNE@("encounterProvider")=$G(IMMUNIZEARR(FNBR1,IENS1,1204,"E"))
 S @IMMUNE@("encounterProviderId")=$G(IMMUNIZEARR(FNBR1,IENS1,1204,"I"))
 S @IMMUNE@("encounterProviderNPI")=$$GET1^DIQ(200,@IMMUNE@("encounterProviderId")_",",41.99) ;NPI
 S @IMMUNE@("encounterProviderResId")=$$RESID^SYNDHP69("V",SITE,200,@IMMUNE@("encounterProviderId"))
 S @IMMUNE@("dateTimeRecorded")=$G(IMMUNIZEARR(FNBR1,IENS1,1205,"E"))
 S @IMMUNE@("dateTimeRecordedFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1205,"I"))
 S @IMMUNE@("dateTimeRecordedHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1205,"I")))
 S @IMMUNE@("dateTimeRecordedFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1205,"I")))
 S @IMMUNE@("immunizationDocumenter")=$G(IMMUNIZEARR(FNBR1,IENS1,1206,"E"))
 S @IMMUNE@("immunizationDocumenterId")=$G(IMMUNIZEARR(FNBR1,IENS1,1206,"I"))
 S @IMMUNE@("lotNumber")=$G(IMMUNIZEARR(FNBR1,IENS1,1207,"E"))
 S @IMMUNE@("lotNumberId")=$G(IMMUNIZEARR(FNBR1,IENS1,1207,"I"))
 S @IMMUNE@("parent")=$G(IMMUNIZEARR(FNBR1,IENS1,1208,"E"))
 S @IMMUNE@("parentId")=$G(IMMUNIZEARR(FNBR1,IENS1,1208,"I"))
 S @IMMUNE@("externalKey")=$G(IMMUNIZEARR(FNBR1,IENS1,1209,"E"))
 S @IMMUNE@("outsideProviderName")=$G(IMMUNIZEARR(FNBR1,IENS1,1210,"E"))
 S @IMMUNE@("ancillaryPov")=$G(IMMUNIZEARR(FNBR1,IENS1,1213,"E"))
 S @IMMUNE@("ancillaryPovId")=$G(IMMUNIZEARR(FNBR1,IENS1,1213,"I"))
 S @IMMUNE@("userLastUpdate")=$G(IMMUNIZEARR(FNBR1,IENS1,1214,"E"))
 S @IMMUNE@("userLastUpdateId")=$G(IMMUNIZEARR(FNBR1,IENS1,1214,"I"))
 S @IMMUNE@("orderingLocation")=$G(IMMUNIZEARR(FNBR1,IENS1,1215,"E"))
 S @IMMUNE@("orderingLocationId")=$G(IMMUNIZEARR(FNBR1,IENS1,1215,"I"))
 S @IMMUNE@("dateTimeEntered")=$G(IMMUNIZEARR(FNBR1,IENS1,1216,"E"))
 S @IMMUNE@("dateTimeEnteredFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1216,"I"))
 S @IMMUNE@("dateTimeEnteredHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1216,"I")))
 S @IMMUNE@("dateTimeEnteredFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1216,"I")))
 S @IMMUNE@("enteredBy")=$G(IMMUNIZEARR(FNBR1,IENS1,1217,"E"))
 S @IMMUNE@("enteredById")=$G(IMMUNIZEARR(FNBR1,IENS1,1217,"I"))
 S @IMMUNE@("dateTimeLastModified")=$G(IMMUNIZEARR(FNBR1,IENS1,1218,"E"))
 S @IMMUNE@("dateTimeLastModifiedFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1218,"I"))
 S @IMMUNE@("dateTimeLastModifiedHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1218,"I")))
 S @IMMUNE@("dateTimeLastModifiedFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1218,"I")))
 S @IMMUNE@("lastModifiedBy")=$G(IMMUNIZEARR(FNBR1,IENS1,1219,"E"))
 S @IMMUNE@("lastModifiedById")=$G(IMMUNIZEARR(FNBR1,IENS1,1219,"I"))
 S @IMMUNE@("warningAcknowledged")=$G(IMMUNIZEARR(FNBR1,IENS1,1220,"E"))
 S @IMMUNE@("warningAcknowledgedCd")=$G(IMMUNIZEARR(FNBR1,IENS1,1220,"I"))
 S @IMMUNE@("timestamp")=$G(IMMUNIZEARR(FNBR1,IENS1,1221,"E"))
 S @IMMUNE@("timestampFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1221,"I"))
 S @IMMUNE@("timestampHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1221,"I")))
 S @IMMUNE@("timestampFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1221,"I")))
 S @IMMUNE@("eventInformationSource")=$G(IMMUNIZEARR(FNBR1,IENS1,1301,"E"))
 S @IMMUNE@("eventInformationSourceId")=$G(IMMUNIZEARR(FNBR1,IENS1,1301,"I"))
 S @IMMUNE@("routeOfAdministration")=$G(IMMUNIZEARR(FNBR1,IENS1,1302,"E"))
 S @IMMUNE@("routeOfAdministrationId")=$G(IMMUNIZEARR(FNBR1,IENS1,1302,"I"))
 S @IMMUNE@("siteOfAdministrationBody")=$G(IMMUNIZEARR(FNBR1,IENS1,1303,"E"))
 S @IMMUNE@("siteOfAdministrationBodyId")=$G(IMMUNIZEARR(FNBR1,IENS1,1303,"I"))
 S @IMMUNE@("primaryDiagnosis")=$G(IMMUNIZEARR(FNBR1,IENS1,1304,"E"))
 S @IMMUNE@("primaryDiagnosisId")=$G(IMMUNIZEARR(FNBR1,IENS1,1304,"I"))
 S @IMMUNE@("dose")=$G(IMMUNIZEARR(FNBR1,IENS1,1312,"E"))
 S @IMMUNE@("dosage")=$G(IMMUNIZEARR(FNBR1,IENS1,1312.5,"E"))
 S @IMMUNE@("doseUnits")=$G(IMMUNIZEARR(FNBR1,IENS1,1313,"E"))
 S @IMMUNE@("doseUnitsId")=$G(IMMUNIZEARR(FNBR1,IENS1,1313,"I"))
 S @IMMUNE@("results")=$G(IMMUNIZEARR(FNBR1,IENS1,1401,"E"))
 S @IMMUNE@("resultsCd")=$G(IMMUNIZEARR(FNBR1,IENS1,1401,"I"))
 S @IMMUNE@("reading")=$G(IMMUNIZEARR(FNBR1,IENS1,1402,"E"))
 S @IMMUNE@("dateTimeRead")=$G(IMMUNIZEARR(FNBR1,IENS1,1403,"E"))
 S @IMMUNE@("dateTimeReadFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1403,"I"))
 S @IMMUNE@("dateTimeReadHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1403,"I")))
 S @IMMUNE@("dateTimeReadFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1403,"I")))
 S @IMMUNE@("reader")=$G(IMMUNIZEARR(FNBR1,IENS1,1404,"E"))
 S @IMMUNE@("readerId")=$G(IMMUNIZEARR(FNBR1,IENS1,1404,"I"))
 S @IMMUNE@("readingRecorded")=$G(IMMUNIZEARR(FNBR1,IENS1,1405,"E"))
 S @IMMUNE@("readingRecordedFM")=$G(IMMUNIZEARR(FNBR1,IENS1,1405,"I"))
 S @IMMUNE@("readingRecordedHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR1,IENS1,1405,"I")))
 S @IMMUNE@("readingRecordedFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR1,IENS1,1405,"I")))
 S @IMMUNE@("hoursReadPostInoculation")=$G(IMMUNIZEARR(FNBR1,IENS1,1406,"E"))
 S @IMMUNE@("readingComment")=$G(IMMUNIZEARR(FNBR1,IENS1,1501,"E"))
 S @IMMUNE@("warningOverrideReason")=$G(IMMUNIZEARR(FNBR1,IENS1,1601,"E"))
 S @IMMUNE@("editedFlag")=$G(IMMUNIZEARR(FNBR1,IENS1,80101,"E"))
 S @IMMUNE@("editedFlagCd")=$G(IMMUNIZEARR(FNBR1,IENS1,80101,"I"))
 S @IMMUNE@("auditTrail")=$G(IMMUNIZEARR(FNBR1,IENS1,80102,"E"))
 S @IMMUNE@("comments")=$G(IMMUNIZEARR(FNBR1,IENS1,81101,"E"))
 S @IMMUNE@("verified")=$G(IMMUNIZEARR(FNBR1,IENS1,81201,"E"))
 S @IMMUNE@("verifiedCd")=$G(IMMUNIZEARR(FNBR1,IENS1,81201,"I"))
 S @IMMUNE@("package")=$G(IMMUNIZEARR(FNBR1,IENS1,81202,"E"))
 S @IMMUNE@("packageId")=$G(IMMUNIZEARR(FNBR1,IENS1,81202,"I"))
 S @IMMUNE@("dataSource")=$G(IMMUNIZEARR(FNBR1,IENS1,81203,"E"))
 S @IMMUNE@("dataSourceId")=$G(IMMUNIZEARR(FNBR1,IENS1,81203,"I"))
 N OFFER
 N IENS2 S IENS2=""
 F  S IENS2=$O(IMMUNIZEARR(FNBR2,IENS2)) QUIT:IENS2=""  D
 . S OFFER=$NA(IMMUNIZE("Immunize","visOfferedGivenToPatients","visOfferedGivenToPatient",+IENS2))
 . S @OFFER@("visOfferedGivenToPatient")=$G(IMMUNIZEARR(FNBR2,IENS2,.01,"E"))
 . S @OFFER@("visOfferedGivenToPatientId")=$G(IMMUNIZEARR(FNBR2,IENS2,.01,"I"))
 . S @OFFER@("dateVisOfferedGiven")=$G(IMMUNIZEARR(FNBR2,IENS2,.02,"E"))
 . S @OFFER@("dateVisOfferedGivenFM")=$G(IMMUNIZEARR(FNBR2,IENS2,.02,"I"))
 . S @OFFER@("dateVisOfferedGivenHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR2,IENS2,.02,"I")))
 . S @OFFER@("dateVisOfferedGivenFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR2,IENS2,.02,"I")))
 . S @OFFER@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,IMMUNIEN,FNBR2_U_+IENS2)
 N OTHERDX
 N IENS3 S IENS3=""
 F  S IENS3=$O(IMMUNIZEARR(FNBR3,IENS3)) QUIT:IENS3=""  D
 . S OTHERDX=$NA(IMMUNIZE("Immunize","otherDiagnosiss","otherDiagnosis",+IENS3))
 . S @OTHERDX@("otherDiagnosis")=$G(IMMUNIZEARR(FNBR3,IENS3,.01,"E"))
 . S @OTHERDX@("otherDiagnosisId")=$G(IMMUNIZEARR(FNBR3,IENS3,.01,"I"))
 . S @OTHERDX@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,IMMUNIEN,FNBR3_U_+IENS3)
 N DISCLOSE
 N IENS4 S IENS4=""
 F  S IENS4=$O(IMMUNIZEARR(FNBR4,IENS4)) QUIT:IENS4=""  D
 . S DISCLOSE=$NA(IMMUNIZE("Immunize","disclosedTos","disclosedTo",+IENS4))
 . S @DISCLOSE@("agency")=$G(IMMUNIZEARR(FNBR4,IENS4,.01,"E"))
 . S @DISCLOSE@("agencyId")=$G(IMMUNIZEARR(FNBR4,IENS4,.01,"I"))
 . S @DISCLOSE@("disclosureDateTime")=$G(IMMUNIZEARR(FNBR4,IENS4,.02,"E"))
 . S @DISCLOSE@("disclosureDateTimeFM")=$G(IMMUNIZEARR(FNBR4,IENS4,.02,"I"))
 . S @DISCLOSE@("disclosureDateTimeHL7")=$$FMTHL7^XLFDT($G(IMMUNIZEARR(FNBR4,IENS4,.02,"I")))
 . S @DISCLOSE@("disclosureDateTimeFHIR")=$$FMTFHIR^SYNDHPUTL($G(IMMUNIZEARR(FNBR4,IENS4,.02,"I")))
 . S @DISCLOSE@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,IMMUNIEN,FNBR4_U_+IENS4)
 ;N IENS5 S IENS5="" ;Word processing field 1101 above
 ;F  S IENS5=$O(IMMUNIZEARR(FNBR5,IENS5)) QUIT:IENS5=""  D
 ;. S IMMUNIZE("Immunize","remarkss","remarks",+IENS5,"remarks")=$G(IMMUNIZEARR(FNBR5,IENS5,.01,"E"))
 N SNOMED
 N IENS6 S IENS6=""
 F  S IENS6=$O(IMMUNIZEARR(FNBR6,IENS6)) QUIT:IENS6=""  D
 . S SNOMED=$NA(IMMUNIZE("Immunize","snomedCts","snomedCt",+IENS6))
 . S @SNOMED@("snomedCt")=$G(IMMUNIZEARR(FNBR6,IENS6,.01,"E"))
 . S @SNOMED@("snomedPreferredTerm")=$G(IMMUNIZEARR(FNBR6,IENS6,.019,"E"))
 . S @SNOMED@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,IMMUNIEN,FNBR6_U_+IENS6)
 N LOINC
 N IENS7 S IENS7=""
 F  S IENS7=$O(IMMUNIZEARR(FNBR7,IENS7)) QUIT:IENS7=""  D
 . S LOINC=$NA(IMMUNIZE("Immunize","loincCodess","loincCodes",+IENS7))
 . S @LOINC@("loincCodes")=$G(IMMUNIZEARR(FNBR7,IENS7,.01,"E"))
 . S @LOINC@("loincText")=$G(IMMUNIZEARR(FNBR7,IENS7,.019,"E"))
 . S @LOINC@("resourceId")=$$RESID^SYNDHP69("V",SITE,FNBR1,IMMUNIEN,FNBR7_U_+IENS7)
 ;
 I $G(DEBUG) W ! W $$ZW^SYNDHPUTL("IMMUNIZE")
 ;
 D:$G(RETJSON)="J" TOJASON^SYNDHPUTL(.IMMUNIZE,.IMMUNIZEJ)
 ;
 QUIT
 ;
